#include <odin.h>
#include <odinwrap.h>
#include <os2sel.h>

#include <os2win.h>
#include <winreg.h>
#include <winnt.h>
#include <wincon.h>
#include <winthunk.h>
#include <winnls.h>
#include <ntddk.h>
#include <heapstring.h>

#define DBG_LOCALLOG    DBG_trace
#include <dbglocal.h>

#define DBGWRAP_MODULE "KERNEL32"
#include <dbgwrap.h>

LPVOID WIN32API CreateFiber( DWORD dwStackSize,
                             LPVOID lpStartAddress,
                             LPVOID lpParameter);

VOID WIN32API DeleteFiber(LPVOID lpFiber);
HANDLE WIN32API BeginUpdateResourceA( LPCSTR pFileName,
                                       BOOL bDeleteExistingResources);
HANDLE WIN32API BeginUpdateResourceW( LPCWSTR pFileName,
                                       BOOL bDeleteExistingResources);

BOOL WINAPI CloseProfileUserMapping(void) ;
BOOL WIN32API EndUpdateResourceA(HANDLE hUpdate,BOOL fDiscard);
BOOL WIN32API EndUpdateResourceW(HANDLE hUpdate,BOOL fDiscard);
DWORD WIN32API CmdBatNotification(DWORD x1);

BOOL WINAPI OpenProfileUserMapping(void);

DWORD WIN32API ThunkConnect32(LPVOID,  LPSTR thunkfun16,
                              LPSTR module16, LPSTR module32, HMODULE hmod32,
                              DWORD dllinitarg1 );

BOOL WIN32API UpdateResourceA(HANDLE  hUpdateFile,
                                 LPCTSTR lpszType,
                                 LPCTSTR lpszName,
                                 WORD    IDLanguage,
                                 LPVOID  lpvData,
                                 DWORD   cbData);
BOOL WIN32API UpdateResourceW(HANDLE  hUpdateFile,
                              LPCWSTR lpszType,
                              LPCWSTR lpszName,
                              WORD    IDLanguage,
                              LPVOID  lpvData,
                              DWORD   cbData);
DWORD WIN32API GetVDMCurrentDirectories(DWORD x1);
BOOL WIN32API GetSystemTimeAdjustment(PDWORD lpTimeAdjustment,
                                         PDWORD lpTimeIncrement,
                                         PBOOL  lpTimeAdjustmentDisabled);
BOOL WIN32API SetSystemTimeAdjustment(DWORD dwTimeAdjustment,
                                         BOOL  bTimeAdjustmentDisabled);

BOOL WIN32API SystemTimeToTzSpecificLocalTime(LPTIME_ZONE_INFORMATION arg1,
                                              LPSYSTEMTIME arg2,
                                              LPSYSTEMTIME arg3);
FARPROC WIN32API GetProcAddress16(HMODULE hModule, LPCSTR lpszProc);


DEBUGWRAP4(LoadLibrary16);
DEBUGWRAP4(FreeLibrary16);
DEBUGWRAP8(GetProcAddress16);
DEBUGWRAP4(ReleaseThunkLock);
DEBUGWRAP4(RestoreThunkLock);
DEBUGWRAP0(_ConfirmWin16Lock);
DEBUGWRAP4(AddAtomA);
DEBUGWRAP4(AddAtomW);
DEBUGWRAP0(AllocConsole);
DEBUGWRAP0(AreFileApisANSI);
DEBUGWRAP8(BeginUpdateResourceA);
DEBUGWRAP8(BeginUpdateResourceW);
DEBUGWRAP28(BackupRead)
DEBUGWRAP24(BackupSeek);
DEBUGWRAP28(BackupWrite);
DEBUGWRAP8(Beep);
DEBUGWRAP8(BuildCommDCBA);
DEBUGWRAP12(BuildCommDCBAndTimeoutsA);
DEBUGWRAP12(BuildCommDCBAndTimeoutsW);
DEBUGWRAP8(BuildCommDCBW);
DEBUGWRAP28(CallNamedPipeA);
DEBUGWRAP28(CallNamedPipeW);
DEBUGWRAP4(CancelIo);
DEBUGWRAP4(CancelWaitableTimer);
DEBUGWRAP4(ClearCommBreak);
DEBUGWRAP12(ClearCommError);
DEBUGWRAP4(CloseHandle);
DEBUGWRAP0(CloseProfileUserMapping);
DEBUGWRAP4(CmdBatNotification);
DEBUGWRAP12(CommConfigDialogA);
DEBUGWRAP12(CommConfigDialogW);
DEBUGWRAP8(CompareFileTime);
DEBUGWRAP24(CompareStringA);
DEBUGWRAP24(CompareStringW);
DEBUGWRAP8(ConnectNamedPipe);
DEBUGWRAP12(ContinueDebugEvent);
DEBUGWRAP4(ConvertDefaultLocale);
DEBUGWRAP4(ConvertToGlobalHandle);
DEBUGWRAP12(CopyFileA);
DEBUGWRAP24(CopyFileExA);
DEBUGWRAP24(CopyFileExW);
DEBUGWRAP12(CopyFileW);
DEBUGWRAP20(CreateConsoleScreenBuffer);
DEBUGWRAP8(CreateDirectoryA);
DEBUGWRAP12(CreateDirectoryExA);
DEBUGWRAP12(CreateDirectoryExW);
DEBUGWRAP8(CreateDirectoryW);
DEBUGWRAP16(CreateEventA);
DEBUGWRAP16(CreateEventW);
DEBUGWRAP12(CreateFiber);
DEBUGWRAP28(CreateFileA);
DEBUGWRAP28(CreateFileW);
DEBUGWRAP24(CreateFileMappingA);
DEBUGWRAP24(CreateFileMappingW);
DEBUGWRAP16(CreateIoCompletionPort);
DEBUGWRAP16(CreateMailslotA);
DEBUGWRAP16(CreateMailslotW);
DEBUGWRAP12(CreateMutexA);
DEBUGWRAP12(CreateMutexW);
DEBUGWRAP32(CreateNamedPipeA);
DEBUGWRAP32(CreateNamedPipeW);
DEBUGWRAP16(CreatePipe);
DEBUGWRAP40(CreateProcessA);
DEBUGWRAP40(CreateProcessW);
DEBUGWRAP28(CreateRemoteThread);
DEBUGWRAP16(CreateSemaphoreA);
DEBUGWRAP16(CreateSemaphoreW);
DEBUGWRAP16(CreateTapePartition);
DEBUGWRAP24(CreateThread);
DEBUGWRAP12(CreateWaitableTimerA);
DEBUGWRAP12(CreateWaitableTimerW);
DEBUGWRAP4(DebugActiveProcess);
DEBUGWRAP0(DebugBreak);
DEBUGWRAP12(DefineDosDeviceA);
DEBUGWRAP12(DefineDosDeviceW);
DEBUGWRAP4(DeleteAtom);
//DEBUGWRAP4(DeleteCriticalSection);
DEBUGWRAP4(DeleteFiber);
DEBUGWRAP4(DeleteFileA);
DEBUGWRAP4(DeleteFileW);
DEBUGWRAP32(DeviceIoControl);
DEBUGWRAP4(DisableThreadLibraryCalls);
DEBUGWRAP4(DisconnectNamedPipe);
DEBUGWRAP12(DosDateTimeToFileTime);
DEBUGWRAP28(DuplicateHandle);
DEBUGWRAP8(EndUpdateResourceA);
DEBUGWRAP8(EndUpdateResourceW);
//DEBUGWRAP4(EnterCriticalSection);
DEBUGWRAP16(EnumCalendarInfoA);
DEBUGWRAP16(EnumCalendarInfoW);
DEBUGWRAP12(EnumDateFormatsA);
DEBUGWRAP12(EnumDateFormatsW);
DEBUGWRAP20(EnumResourceLanguagesA);
DEBUGWRAP20(EnumResourceLanguagesW);
DEBUGWRAP16(EnumResourceNamesA);
DEBUGWRAP16(EnumResourceNamesW);
DEBUGWRAP12(EnumResourceTypesA);
DEBUGWRAP12(EnumResourceTypesW);
DEBUGWRAP8(EnumSystemCodePagesA);
DEBUGWRAP8(EnumSystemCodePagesW);
DEBUGWRAP8(EnumSystemLocalesA);
DEBUGWRAP8(EnumSystemLocalesW);
DEBUGWRAP12(EnumTimeFormatsA);
DEBUGWRAP12(EnumTimeFormatsW);
DEBUGWRAP12(EraseTape);
DEBUGWRAP8(EscapeCommFunction);
DEBUGWRAP4(ExitProcess);
DEBUGWRAP4(ExitThread);
DEBUGWRAP12(ExpandEnvironmentStringsA);
DEBUGWRAP12(ExpandEnvironmentStringsW);
DEBUGWRAP4(FT_Exit0);
DEBUGWRAP4(FT_Exit12);
DEBUGWRAP4(FT_Exit16);
DEBUGWRAP4(FT_Exit20);
DEBUGWRAP4(FT_Exit24);
DEBUGWRAP4(FT_Exit28);
DEBUGWRAP4(FT_Exit32);
DEBUGWRAP4(FT_Exit36);
DEBUGWRAP4(FT_Exit4);
DEBUGWRAP4(FT_Exit40);
DEBUGWRAP4(FT_Exit44);
DEBUGWRAP4(FT_Exit48);
DEBUGWRAP4(FT_Exit52);
DEBUGWRAP4(FT_Exit56);
DEBUGWRAP4(FT_Exit8);
DEBUGWRAP4(FT_Prolog);
DEBUGWRAP4(FT_Thunk);
DEBUGWRAP8(FatalAppExitA);
DEBUGWRAP8(FatalAppExitW);
DEBUGWRAP4(FatalExit);
DEBUGWRAP12(FileTimeToDosDateTime);
DEBUGWRAP8(FileTimeToLocalFileTime);
DEBUGWRAP8(FileTimeToSystemTime);
DEBUGWRAP20(FillConsoleOutputAttribute);
DEBUGWRAP20(FillConsoleOutputCharacterA);
DEBUGWRAP20(FillConsoleOutputCharacterW);
DEBUGWRAP4(FindAtomA);
DEBUGWRAP4(FindAtomW);
DEBUGWRAP4(FindClose);
DEBUGWRAP4(FindCloseChangeNotification);
DEBUGWRAP12(FindFirstChangeNotificationA);
DEBUGWRAP12(FindFirstChangeNotificationW);
DEBUGWRAP8(FindFirstFileA);
DEBUGWRAP24(FindFirstFileExA);
DEBUGWRAP24(FindFirstFileExW);
DEBUGWRAP8(FindFirstFileW);
DEBUGWRAP4(FindNextChangeNotification);
DEBUGWRAP8(FindNextFileA);
DEBUGWRAP8(FindNextFileW);
DEBUGWRAP12(FindResourceA);
DEBUGWRAP16(FindResourceExA);
DEBUGWRAP16(FindResourceExW);
DEBUGWRAP12(FindResourceW);
DEBUGWRAP4(FlushConsoleInputBuffer);
DEBUGWRAP4(FlushFileBuffers);
DEBUGWRAP12(FlushInstructionCache);
DEBUGWRAP8(FlushViewOfFile);
DEBUGWRAP20(FoldStringA);
DEBUGWRAP20(FoldStringW);
DEBUGWRAP28(FormatMessageA);
DEBUGWRAP28(FormatMessageW);
DEBUGWRAP0(FreeConsole);
DEBUGWRAP4(FreeEnvironmentStringsA);
DEBUGWRAP4(FreeEnvironmentStringsW);
DEBUGWRAP4(FreeLibrary);
DEBUGWRAP8(FreeLibraryAndExitThread);
DEBUGWRAP4(FreeResource);
DEBUGWRAP8(GenerateConsoleCtrlEvent);
DEBUGWRAP0(GetACP);
DEBUGWRAP12(GetAtomNameA);
DEBUGWRAP12(GetAtomNameW);
DEBUGWRAP8(GetBinaryTypeA);
DEBUGWRAP8(GetBinaryTypeW);
DEBUGWRAP8(GetCPInfo);
DEBUGWRAP12(GetCommConfig);
DEBUGWRAP8(GetCommMask);
DEBUGWRAP8(GetCommModemStatus);
DEBUGWRAP8(GetCommProperties);
DEBUGWRAP8(GetCommState);
DEBUGWRAP8(GetCommTimeouts);
DEBUGWRAP0(GetCommandLineA);
DEBUGWRAP0(GetCommandLineW);
DEBUGWRAP8(GetCompressedFileSizeA);
DEBUGWRAP8(GetCompressedFileSizeW);
DEBUGWRAP8(GetComputerNameA);
DEBUGWRAP8(GetComputerNameW);
DEBUGWRAP0(GetConsoleCP);
DEBUGWRAP8(GetConsoleCursorInfo);
DEBUGWRAP8(GetConsoleMode);
DEBUGWRAP0(GetConsoleOutputCP);
DEBUGWRAP8(GetConsoleScreenBufferInfo);
DEBUGWRAP8(GetConsoleTitleA);
DEBUGWRAP8(GetConsoleTitleW);
DEBUGWRAP24(GetCurrencyFormatA);
DEBUGWRAP24(GetCurrencyFormatW);
DEBUGWRAP8(GetCurrentDirectoryA);
DEBUGWRAP8(GetCurrentDirectoryW);
DEBUGWRAP0(GetCurrentProcess);
DEBUGWRAP0(GetCurrentProcessId);
DEBUGWRAP0(GetCurrentThread);
DEBUGWRAP0(GetCurrentThreadId);
DEBUGWRAP24(GetDateFormatA);
DEBUGWRAP24(GetDateFormatW);
DEBUGWRAP12(GetDefaultCommConfigA);
DEBUGWRAP12(GetDefaultCommConfigW);
DEBUGWRAP20(GetDiskFreeSpaceA);
DEBUGWRAP20(GetDiskFreeSpaceW);
DEBUGWRAP4(GetDriveTypeA);
DEBUGWRAP4(GetDriveTypeW);
DEBUGWRAP0(GetEnvironmentStringsA);
DEBUGWRAP0(GetEnvironmentStringsW);
DEBUGWRAP12(GetEnvironmentVariableA);
DEBUGWRAP12(GetEnvironmentVariableW);
DEBUGWRAP8(GetExitCodeProcess);
DEBUGWRAP8(GetExitCodeThread);
DEBUGWRAP4(GetFileAttributesA);
DEBUGWRAP4(GetFileAttributesW);
DEBUGWRAP8(GetFileInformationByHandle);
DEBUGWRAP8(GetFileSize);
DEBUGWRAP16(GetFileTime);
DEBUGWRAP4(GetFileType);
DEBUGWRAP16(GetFullPathNameA);
DEBUGWRAP16(GetFullPathNameW);
DEBUGWRAP8(GetHandleInformation);
DEBUGWRAP4(GetLargestConsoleWindowSize);
DEBUGWRAP0(GetLastError);
DEBUGWRAP4(GetLocalTime);
DEBUGWRAP16(GetLocaleInfoA);
DEBUGWRAP16(GetLocaleInfoW);
DEBUGWRAP8(GetLogicalDriveStringsA);
DEBUGWRAP8(GetLogicalDriveStringsW);
DEBUGWRAP0(GetLogicalDrives);
DEBUGWRAP20(GetMailslotInfo);
DEBUGWRAP12(GetModuleFileNameA);
DEBUGWRAP12(GetModuleFileNameW);
DEBUGWRAP4(GetModuleHandleA);
DEBUGWRAP4(GetModuleHandleW);
DEBUGWRAP28(GetNamedPipeHandleStateA);
DEBUGWRAP28(GetNamedPipeHandleStateW);
DEBUGWRAP20(GetNamedPipeInfo);
DEBUGWRAP24(GetNumberFormatA);
DEBUGWRAP24(GetNumberFormatW);
DEBUGWRAP8(GetNumberOfConsoleInputEvents);
DEBUGWRAP4(GetNumberOfConsoleMouseButtons);
DEBUGWRAP0(GetOEMCP);
DEBUGWRAP16(GetOverlappedResult);
DEBUGWRAP4(GetPriorityClass);
DEBUGWRAP16(GetPrivateProfileIntA);
DEBUGWRAP16(GetPrivateProfileIntW);
DEBUGWRAP16(GetPrivateProfileSectionA);
DEBUGWRAP12(GetPrivateProfileSectionNamesA);
DEBUGWRAP12(GetPrivateProfileSectionNamesW);
DEBUGWRAP16(GetPrivateProfileSectionW);
DEBUGWRAP24(GetPrivateProfileStringA);
DEBUGWRAP24(GetPrivateProfileStringW);
DEBUGWRAP20(GetPrivateProfileStructA);
DEBUGWRAP20(GetPrivateProfileStructW);
DEBUGWRAP8(GetProcAddress);
DEBUGWRAP12(GetProcessAffinityMask);
DEBUGWRAP8(GetProcessDword);
DEBUGWRAP4(GetProcessFlags);
DEBUGWRAP0(GetProcessHeap);
DEBUGWRAP8(GetProcessHeaps);
DEBUGWRAP8(GetProcessShutdownParameters);
DEBUGWRAP20(GetProcessTimes);
DEBUGWRAP4(GetProcessVersion);
DEBUGWRAP12(GetProcessWorkingSetSize);
DEBUGWRAP12(GetProfileIntA);
DEBUGWRAP12(GetProfileIntW);
DEBUGWRAP12(GetProfileSectionA);
DEBUGWRAP12(GetProfileSectionW);
DEBUGWRAP20(GetProfileStringA);
DEBUGWRAP20(GetProfileStringW);
DEBUGWRAP20(GetQueuedCompletionStatus);
DEBUGWRAP12(GetShortPathNameA);
DEBUGWRAP12(GetShortPathNameW);
DEBUGWRAP4(GetStartupInfoA);
DEBUGWRAP4(GetStartupInfoW);
DEBUGWRAP4(GetStdHandle);
DEBUGWRAP20(GetStringTypeA);
DEBUGWRAP20(GetStringTypeExA);
DEBUGWRAP20(GetStringTypeExW);
DEBUGWRAP16(GetStringTypeW);
DEBUGWRAP0(GetSystemDefaultLCID);
DEBUGWRAP0(GetSystemDefaultLangID);
DEBUGWRAP8(GetSystemDirectoryA);
DEBUGWRAP8(GetSystemDirectoryW);
DEBUGWRAP4(GetSystemInfo);
DEBUGWRAP4(GetSystemPowerStatus);
DEBUGWRAP4(GetSystemTime);
DEBUGWRAP12(GetSystemTimeAdjustment);
DEBUGWRAP4(GetSystemTimeAsFileTime);
DEBUGWRAP16(GetTapeParameters);
DEBUGWRAP20(GetTapePosition);
DEBUGWRAP4(GetTapeStatus);
DEBUGWRAP16(GetTempFileNameA);
DEBUGWRAP16(GetTempFileNameW);
DEBUGWRAP8(GetTempPathA);
DEBUGWRAP8(GetTempPathW);
DEBUGWRAP8(GetThreadContext);
DEBUGWRAP0(GetThreadLocale);
DEBUGWRAP4(GetThreadPriority);
DEBUGWRAP12(GetThreadSelectorEntry);
DEBUGWRAP20(GetThreadTimes);
DEBUGWRAP0(GetTickCount);
DEBUGWRAP24(GetTimeFormatA);
DEBUGWRAP24(GetTimeFormatW);
DEBUGWRAP4(GetTimeZoneInformation);
DEBUGWRAP0(GetUserDefaultLCID);
DEBUGWRAP0(GetUserDefaultLangID);
DEBUGWRAP4(GetVDMCurrentDirectories);
DEBUGWRAP0(GetVersion);
DEBUGWRAP4(GetVersionExA);
DEBUGWRAP4(GetVersionExW);
DEBUGWRAP32(GetVolumeInformationA);
DEBUGWRAP32(GetVolumeInformationW);
DEBUGWRAP8(GetWindowsDirectoryA);
DEBUGWRAP8(GetWindowsDirectoryW);
DEBUGWRAP4(GlobalAddAtomA);
DEBUGWRAP4(GlobalAddAtomW);
DEBUGWRAP8(GlobalAlloc);
DEBUGWRAP4(GlobalCompact);
DEBUGWRAP4(GlobalDeleteAtom);
DEBUGWRAP4(GlobalFindAtomA);
DEBUGWRAP4(GlobalFindAtomW);
DEBUGWRAP4(GlobalFix);
DEBUGWRAP4(GlobalFlags);
DEBUGWRAP4(GlobalFree);
DEBUGWRAP12(GlobalGetAtomNameA);
DEBUGWRAP12(GlobalGetAtomNameW);
DEBUGWRAP4(GlobalHandle);
DEBUGWRAP4(GlobalLock);
DEBUGWRAP4(GlobalMemoryStatus);
DEBUGWRAP12(GlobalReAlloc);
DEBUGWRAP4(GlobalSize);
DEBUGWRAP4(GlobalUnWire);
DEBUGWRAP4(GlobalUnfix);
DEBUGWRAP4(GlobalUnlock);
DEBUGWRAP4(GlobalWire);
DEBUGWRAP12(HeapAlloc);
DEBUGWRAP8(HeapCompact);
DEBUGWRAP12(HeapCreate);
DEBUGWRAP4(HeapDestroy);
DEBUGWRAP12(HeapFree);
DEBUGWRAP4(HeapLock);
DEBUGWRAP16(HeapReAlloc);
DEBUGWRAP12(HeapSize);
DEBUGWRAP4(HeapUnlock);
DEBUGWRAP12(HeapValidate);
DEBUGWRAP8(HeapWalk);
DEBUGWRAP4(InitAtomTable);
//DEBUGWRAP4(InitializeCriticalSection);
//DEBUGWRAP12(InterlockedCompareExchange);
//DEBUGWRAP4(InterlockedDecrement);
//DEBUGWRAP8(InterlockedExchange);
//DEBUGWRAP8(InterlockedExchangeAdd);
//DEBUGWRAP4(InterlockedIncrement);
DEBUGWRAP4(IsBadCodePtr);
DEBUGWRAP8(IsBadHugeReadPtr);
DEBUGWRAP8(IsBadHugeWritePtr);
DEBUGWRAP8(IsBadReadPtr);
DEBUGWRAP8(IsBadStringPtrA);
DEBUGWRAP8(IsBadStringPtrW);
DEBUGWRAP8(IsBadWritePtr);
DEBUGWRAP4(IsDBCSLeadByte);
DEBUGWRAP8(IsDBCSLeadByteEx);
DEBUGWRAP0(IsDebuggerPresent);
DEBUGWRAP4(IsValidCodePage);
DEBUGWRAP8(IsValidLocale);
DEBUGWRAP4(K32Thk1632Epilog);
DEBUGWRAP4(K32Thk1632Prolog);
DEBUGWRAP24(LCMapStringA);
DEBUGWRAP24(LCMapStringW);
//DEBUGWRAP4(LeaveCriticalSection);
DEBUGWRAP4(LoadLibraryA);
DEBUGWRAP12(LoadLibraryExA);
DEBUGWRAP12(LoadLibraryExW);
DEBUGWRAP4(LoadLibraryW);
DEBUGWRAP8(LoadModule);
DEBUGWRAP8(LoadResource);
DEBUGWRAP8(LocalAlloc);
DEBUGWRAP4(LocalCompact);
DEBUGWRAP8(LocalFileTimeToFileTime);
DEBUGWRAP4(LocalFlags);
DEBUGWRAP4(LocalFree);
DEBUGWRAP4(LocalHandle);
DEBUGWRAP4(LocalLock);
DEBUGWRAP12(LocalReAlloc);
DEBUGWRAP8(LocalShrink);
DEBUGWRAP4(LocalSize);
DEBUGWRAP4(LocalUnlock);
DEBUGWRAP20(LockFile);
DEBUGWRAP24(LockFileEx);
DEBUGWRAP4(LockResource);
//DEBUGWRAP4(MakeCriticalSectionGlobal);
DEBUGWRAP4(MapLS);
DEBUGWRAP4(MapSLFix);
DEBUGWRAP20(MapViewOfFile);
DEBUGWRAP24(MapViewOfFileEx);
DEBUGWRAP8(MoveFileA);
DEBUGWRAP12(MoveFileExA);
DEBUGWRAP12(MoveFileExW);
DEBUGWRAP8(MoveFileW);
DEBUGWRAP12(MulDiv);
DEBUGWRAP24(MultiByteToWideChar);
DEBUGWRAP12(OpenEventA);
DEBUGWRAP12(OpenEventW);
DEBUGWRAP12(OpenFile);
DEBUGWRAP12(OpenFileMappingA);
DEBUGWRAP12(OpenFileMappingW);
DEBUGWRAP12(OpenMutexA);
DEBUGWRAP12(OpenMutexW);
DEBUGWRAP12(OpenProcess);
DEBUGWRAP0(OpenProfileUserMapping);
DEBUGWRAP12(OpenSemaphoreA);
DEBUGWRAP12(OpenSemaphoreW);
DEBUGWRAP4(OutputDebugStringA);
DEBUGWRAP4(OutputDebugStringW);
DEBUGWRAP16(PeekConsoleInputA);
DEBUGWRAP16(PeekConsoleInputW);
DEBUGWRAP24(PeekNamedPipe);
DEBUGWRAP16(PostQueuedCompletionStatus);
DEBUGWRAP12(PrepareTape);
DEBUGWRAP4(PulseEvent);
DEBUGWRAP8(PurgeComm);
DEBUGWRAP4(QT_Thunk);
DEBUGWRAP12(QueryDosDeviceA);
DEBUGWRAP12(QueryDosDeviceW);
DEBUGWRAP4(QueryPerformanceCounter);
DEBUGWRAP4(QueryPerformanceFrequency);
DEBUGWRAP16(RaiseException);
DEBUGWRAP20(ReadConsoleA);
DEBUGWRAP16(ReadConsoleInputA);
DEBUGWRAP16(ReadConsoleInputW);
DEBUGWRAP20(ReadConsoleOutputA);
DEBUGWRAP20(ReadConsoleOutputAttribute);
DEBUGWRAP20(ReadConsoleOutputCharacterA);
DEBUGWRAP20(ReadConsoleOutputCharacterW);
DEBUGWRAP20(ReadConsoleOutputW);
DEBUGWRAP20(ReadConsoleW);
DEBUGWRAP20(ReadFile);
DEBUGWRAP20(ReadFileEx);
DEBUGWRAP20(ReadProcessMemory);
DEBUGWRAP8(RegisterServiceProcess);
//DEBUGWRAP4(ReinitializeCriticalSection);
DEBUGWRAP4(ReleaseMutex);
DEBUGWRAP12(ReleaseSemaphore);
DEBUGWRAP4(RemoveDirectoryA);
DEBUGWRAP4(RemoveDirectoryW);
DEBUGWRAP4(ResetEvent);
DEBUGWRAP4(ResumeThread);
DEBUGWRAP12(RtlFillMemory);
DEBUGWRAP12(RtlMoveMemory);
DEBUGWRAP16(RtlUnwind);
DEBUGWRAP8(RtlZeroMemory);
DEBUGWRAP4(SMapLS);
DEBUGWRAP4(SMapLS_IP_EBP_12);
DEBUGWRAP4(SMapLS_IP_EBP_16);
DEBUGWRAP4(SMapLS_IP_EBP_20);
DEBUGWRAP4(SMapLS_IP_EBP_24);
DEBUGWRAP4(SMapLS_IP_EBP_28);
DEBUGWRAP4(SMapLS_IP_EBP_32);
DEBUGWRAP4(SMapLS_IP_EBP_36);
DEBUGWRAP4(SMapLS_IP_EBP_40);
DEBUGWRAP4(SMapLS_IP_EBP_8);
DEBUGWRAP4(SUnMapLS);
DEBUGWRAP4(SUnMapLS_IP_EBP_12);
DEBUGWRAP4(SUnMapLS_IP_EBP_16);
DEBUGWRAP4(SUnMapLS_IP_EBP_20);
DEBUGWRAP4(SUnMapLS_IP_EBP_24);
DEBUGWRAP4(SUnMapLS_IP_EBP_28);
DEBUGWRAP4(SUnMapLS_IP_EBP_32);
DEBUGWRAP4(SUnMapLS_IP_EBP_36);
DEBUGWRAP4(SUnMapLS_IP_EBP_40);
DEBUGWRAP4(SUnMapLS_IP_EBP_8);
DEBUGWRAP20(ScrollConsoleScreenBufferA);
DEBUGWRAP20(ScrollConsoleScreenBufferW);
DEBUGWRAP24(SearchPathA);
DEBUGWRAP24(SearchPathW);
DEBUGWRAP4(SetCommBreak);
DEBUGWRAP12(SetCommConfig);
DEBUGWRAP8(SetCommMask);
DEBUGWRAP8(SetCommState);
DEBUGWRAP8(SetCommTimeouts);
DEBUGWRAP4(SetComputerNameA);
DEBUGWRAP4(SetComputerNameW);
DEBUGWRAP4(SetConsoleActiveScreenBuffer);
DEBUGWRAP4(SetConsoleCP);
DEBUGWRAP8(SetConsoleCtrlHandler);
DEBUGWRAP8(SetConsoleCursorInfo);
DEBUGWRAP8(SetConsoleCursorPosition);
DEBUGWRAP8(SetConsoleMode);
DEBUGWRAP4(SetConsoleOutputCP);
DEBUGWRAP8(SetConsoleScreenBufferSize);
DEBUGWRAP8(SetConsoleTextAttribute);
DEBUGWRAP4(SetConsoleTitleA);
DEBUGWRAP4(SetConsoleTitleW);
DEBUGWRAP12(SetConsoleWindowInfo);
DEBUGWRAP4(SetCurrentDirectoryA);
DEBUGWRAP4(SetCurrentDirectoryW);
DEBUGWRAP12(SetDefaultCommConfigA);
DEBUGWRAP12(SetDefaultCommConfigW);
DEBUGWRAP4(SetEndOfFile);
DEBUGWRAP8(SetEnvironmentVariableA);
DEBUGWRAP8(SetEnvironmentVariableW);
DEBUGWRAP4(SetErrorMode);
DEBUGWRAP4(SetEvent);
DEBUGWRAP0(SetFileApisToANSI);
DEBUGWRAP0(SetFileApisToOEM);
DEBUGWRAP8(SetFileAttributesA);
DEBUGWRAP8(SetFileAttributesW);
DEBUGWRAP16(SetFilePointer);
DEBUGWRAP16(SetFileTime);
DEBUGWRAP4(SetHandleCount);
DEBUGWRAP12(SetHandleInformation);
DEBUGWRAP4(SetLastError);
DEBUGWRAP4(SetLocalTime);
DEBUGWRAP12(SetLocaleInfoA);
DEBUGWRAP12(SetLocaleInfoW);
DEBUGWRAP8(SetMailslotInfo);
DEBUGWRAP16(SetNamedPipeHandleState);
DEBUGWRAP8(SetPriorityClass);
DEBUGWRAP8(SetProcessAffinityMask);
DEBUGWRAP12(SetProcessDword);
DEBUGWRAP8(SetProcessPriorityBoost);
DEBUGWRAP8(SetProcessShutdownParameters);
DEBUGWRAP12(SetProcessWorkingSetSize);
DEBUGWRAP8(SetStdHandle);
DEBUGWRAP8(SetSystemPowerState);
DEBUGWRAP4(SetSystemTime);
DEBUGWRAP8(SetSystemTimeAdjustment);
DEBUGWRAP12(SetTapeParameters);
DEBUGWRAP24(SetTapePosition);
DEBUGWRAP8(SetThreadAffinityMask);
DEBUGWRAP8(SetThreadContext);
DEBUGWRAP4(SetThreadLocale);
DEBUGWRAP8(SetThreadPriority);
DEBUGWRAP8(SetThreadPriorityBoost);
DEBUGWRAP4(SetTimeZoneInformation);
DEBUGWRAP4(SetUnhandledExceptionFilter);
DEBUGWRAP8(SetVolumeLabelA);
DEBUGWRAP8(SetVolumeLabelW);
DEBUGWRAP12(SetupComm);
DEBUGWRAP8(SizeofResource);
DEBUGWRAP4(Sleep);
DEBUGWRAP8(SleepEx);
DEBUGWRAP4(SuspendThread);
DEBUGWRAP8(SystemTimeToFileTime);
DEBUGWRAP12(SystemTimeToTzSpecificLocalTime);
DEBUGWRAP8(TerminateProcess);
DEBUGWRAP8(TerminateThread);
DEBUGWRAP24(ThunkConnect32);
DEBUGWRAP0(TlsAlloc);
DEBUGWRAP4(TlsFree);
DEBUGWRAP4(TlsGetValue);
DEBUGWRAP8(TlsSetValue);
DEBUGWRAP28(TransactNamedPipe);
DEBUGWRAP8(TransmitCommChar);
//DEBUGWRAP4(TryEnterCriticalSection);
DEBUGWRAP4(UnMapLS);
DEBUGWRAP12(UnMapSLFixArray);
DEBUGWRAP4(UnhandledExceptionFilter);
//DEBUGWRAP4(UninitializeCriticalSection);
DEBUGWRAP20(UnlockFile);
DEBUGWRAP20(UnlockFileEx);
DEBUGWRAP4(UnmapViewOfFile);
DEBUGWRAP24(UpdateResourceA);
DEBUGWRAP24(UpdateResourceW);
DEBUGWRAP12(VerLanguageNameA);
DEBUGWRAP12(VerLanguageNameW);
DEBUGWRAP16(VirtualAlloc);
DEBUGWRAP12(VirtualFree);
DEBUGWRAP8(VirtualLock);
DEBUGWRAP16(VirtualProtect);
DEBUGWRAP20(VirtualProtectEx);
DEBUGWRAP12(VirtualQuery);
DEBUGWRAP16(VirtualQueryEx);
DEBUGWRAP8(VirtualUnlock);
DEBUGWRAP12(WaitCommEvent);
DEBUGWRAP8(WaitForDebugEvent);
DEBUGWRAP16(WaitForMultipleObjects);
DEBUGWRAP20(WaitForMultipleObjectsEx);
DEBUGWRAP8(WaitForSingleObject);
DEBUGWRAP12(WaitForSingleObjectEx);
DEBUGWRAP8(WaitNamedPipeA);
DEBUGWRAP8(WaitNamedPipeW);
DEBUGWRAP32(WideCharToMultiByte);
DEBUGWRAP8(WinExec);
DEBUGWRAP20(WriteConsoleA);
DEBUGWRAP16(WriteConsoleInputA);
DEBUGWRAP16(WriteConsoleInputW);
DEBUGWRAP20(WriteConsoleOutputA);
DEBUGWRAP20(WriteConsoleOutputAttribute);
DEBUGWRAP20(WriteConsoleOutputCharacterA);
DEBUGWRAP20(WriteConsoleOutputCharacterW);
DEBUGWRAP20(WriteConsoleOutputW);
DEBUGWRAP20(WriteConsoleW);
DEBUGWRAP20(WriteFile);
DEBUGWRAP20(WriteFileEx);
DEBUGWRAP12(WritePrivateProfileSectionA);
DEBUGWRAP12(WritePrivateProfileSectionW);
DEBUGWRAP16(WritePrivateProfileStringA);
DEBUGWRAP16(WritePrivateProfileStringW);
DEBUGWRAP20(WritePrivateProfileStructA);
DEBUGWRAP20(WritePrivateProfileStructW);
DEBUGWRAP20(WriteProcessMemory);
DEBUGWRAP8(WriteProfileSectionA);
DEBUGWRAP8(WriteProfileSectionW);
DEBUGWRAP12(WriteProfileStringA);
DEBUGWRAP12(WriteProfileStringW);
DEBUGWRAP16(WriteTapemark);
DEBUGWRAP12(_lread);
DEBUGWRAP12(_lwrite);
DEBUGWRAP4(_lclose);
DEBUGWRAP8(_lcreat);
DEBUGWRAP12(_llseek);
DEBUGWRAP8(_lopen);
DEBUGWRAP8(lstrcatA);
DEBUGWRAP8(lstrcatW);
DEBUGWRAP8(lstrcmpA);
DEBUGWRAP8(lstrcmpW);
DEBUGWRAP8(lstrcmpiA);
DEBUGWRAP8(lstrcmpiW);
DEBUGWRAP8(lstrcpyA);
DEBUGWRAP8(lstrcpyW);
DEBUGWRAP12(lstrcpynA);
DEBUGWRAP12(lstrcpynW);
DEBUGWRAP4(lstrlenA);
DEBUGWRAP4(lstrlenW);
DEBUGWRAP12(lstrcpynAtoW);
DEBUGWRAP12(lstrcpynWtoA);
DEBUGWRAP8(lstrcpyAtoW);
DEBUGWRAP8(lstrcpyWtoA);
DEBUGWRAP12(lstrncmpA);
DEBUGWRAP12(lstrncmpW);
DEBUGWRAP16(GetDiskFreeSpaceExA);
DEBUGWRAP16(GetDiskFreeSpaceExW);
DEBUGWRAP4(IsProcessorFeaturePresent);
DEBUGWRAP12(GetFileAttributesExA);
DEBUGWRAP12(GetFileAttributesExW);
DEBUGWRAP12(lstrncmpiA);
DEBUGWRAP12(lstrncmpiW);
DEBUGWRAP12(GetLongPathNameA);
DEBUGWRAP12(GetLongPathNameW);

DEBUGWRAP12(HEAP_xalloc);
DEBUGWRAP16(HEAP_xrealloc);
DEBUGWRAP4(HEAP_malloc);
DEBUGWRAP8(HEAP_realloc);
DEBUGWRAP4(HEAP_size);
DEBUGWRAP4(HEAP_free);
DEBUGWRAP12(HEAP_strdupWtoA);
DEBUGWRAP12(HEAP_strdupAtoW);
DEBUGWRAP12(HEAP_strdupA);
DEBUGWRAP12(HEAP_strdupW);


#undef DBG_LOCALLOG
#define DBG_LOCALLOG    DBG_registry

DEBUGWRAP4(RegCloseKey);
DEBUGWRAP12(RegConnectRegistryA);
DEBUGWRAP12(RegConnectRegistryW);
DEBUGWRAP12(RegCreateKeyA);
DEBUGWRAP36(RegCreateKeyExA);
DEBUGWRAP36(RegCreateKeyExW);
DEBUGWRAP12(RegCreateKeyW);
DEBUGWRAP8(RegDeleteKeyA);
DEBUGWRAP8(RegDeleteKeyW);
DEBUGWRAP8(RegDeleteValueA);
DEBUGWRAP8(RegDeleteValueW);
DEBUGWRAP16(RegEnumKeyA);
DEBUGWRAP32(RegEnumKeyExA);
DEBUGWRAP32(RegEnumKeyExW);
DEBUGWRAP16(RegEnumKeyW);
DEBUGWRAP32(RegEnumValueA);
DEBUGWRAP32(RegEnumValueW);
DEBUGWRAP4(RegFlushKey);
DEBUGWRAP16(RegGetKeySecurity);
DEBUGWRAP12(RegLoadKeyA);
DEBUGWRAP12(RegLoadKeyW);
DEBUGWRAP20(RegNotifyChangeKeyValue);
DEBUGWRAP12(RegOpenKeyA);
DEBUGWRAP20(RegOpenKeyExA);
DEBUGWRAP20(RegOpenKeyExW);
DEBUGWRAP12(RegOpenKeyW);
DEBUGWRAP48(RegQueryInfoKeyA);
DEBUGWRAP48(RegQueryInfoKeyW);
DEBUGWRAP20(RegQueryMultipleValuesA);
DEBUGWRAP20(RegQueryMultipleValuesW);
DEBUGWRAP16(RegQueryValueA);
DEBUGWRAP24(RegQueryValueExA);
DEBUGWRAP24(RegQueryValueExW);
DEBUGWRAP16(RegQueryValueW);
DEBUGWRAP16(RegReplaceKeyA);
DEBUGWRAP16(RegReplaceKeyW);
DEBUGWRAP12(RegRestoreKeyA);
DEBUGWRAP12(RegRestoreKeyW);
DEBUGWRAP12(RegSaveKeyA);
DEBUGWRAP12(RegSaveKeyW);
DEBUGWRAP12(RegSetKeySecurity);
DEBUGWRAP20(RegSetValueA);
DEBUGWRAP24(RegSetValueExA);
DEBUGWRAP24(RegSetValueExW);
DEBUGWRAP20(RegSetValueW);
DEBUGWRAP8(RegUnLoadKeyA);
DEBUGWRAP8(RegUnLoadKeyW);
