/* $Id: changelog,v 1.1384 2001-04-27 19:31:16 sandervl Exp $ */

 2001-04-27: Sander van Leeuwen <sandervl@xs4all.nl>
    - USER32:   o Call WH_GETMESSAGE hook handler from GetMessage and PeekMessage
                  (if message present)
                o Added (not 100% correct) filtering for nonclient mouse messages
                  (fixes nonclient messages for MS Word 97 (frame & menu mouse actions))
                o Recalculate HDC height of windows with CS_OWNDC style if 
                  window is resized.
                  (fixes 28 pixel shift up in MS Word MDI window; Word calls 
                   GetDCEx once and does custom WM_PAINT handling (never calls 
                   Begin/EndPaint))
    - KERNEL32: o HeapReAlloc: return old pointer if new size is smaller or
                               equal to old size.
    - GDI32:    o Limit length of converted strings in InternalDrawTextExW,
                  InternalGetTabbedTextExtentW, InternalTabbedTextOutW &
                  InternalTextOutW. (cbCount might be smaller than string 
                  length)
                  (fixes crash in MS Word when it tries to display the about
                   dialog)
    - INCLUDE\win\unicode: 
                o strcpyW bugfix (didn't terminate string -> heap corruption)
    - DSOUND:   o Preliminary code added for DirectAudio interface. 
                  (not finished & not activated)

 2001-04-26: Sander van Leeuwen <sandervl@xs4all.nl>
    - KERNEL32: o Implemented FreeLibraryAndExitThread
                o Create HandleManager class for mailslots + partial implementation
                  for mailslot APIs (using named pipes)
                o Fixed wrong return values for some CloseHandle methods
                o Fixed CreateNamedPipe; must not call DosCreateNPipe for existing pipe
                  (at least according to the SDK docs; must verify this in NT!)
                o Implemented CreateFile and CloseHandle for named pipe class
                o Implemented SetNamedPipeHandleState
                o GetEnvironmentVariableW fix (breakpoint hit in debug build)
    - ADVAPI32: o IsTextUnicode forwarded to RtlIsTextUnicode (ntdll)
    - GDI32:    o InternalTextOutW fix (breakpoint hit in debug build)
    - OLE32:    o Resync with latest Wine build (20010418)

 2001-04-25: Sander van Leeuwen <sandervl@xs4all.nl>
    - USER32:   o Check visibility of parents in IsWindowVisible
                o Call ShowWindow(SW_MINIMIZE) in CloseWindow (for non-child windows)
                  Don't use PM directly to minimize it.

 2001-04-25: Shingo Tsuda <sofiya@din.or.jp>
    - GDI32:    o DBCS fix for looking up font name in font rename profile section

 2001-04-24: Sander van Leeuwen <sandervl@xs4all.nl>
    - COMDLG32, DPLAYX, OLE32, OLEAUT32:
                o Compile fixes for VAC 3.6.5 (nameless unions & structs)
    - COMDLG32: o Resync with latest Wine code
                  (directory changed after file chosen in file open dialog)

 2001-04-23: Dietrich Teickner <Dietrich_Teickner@t-online.de>
    - SHELL32:  o Updates and fixes for SHFileOperationA (FO_COPY)

 2001-04-22: Sander van Leeuwen <sandervl@xs4all.nl>
    - DDRAW:    o Wrong calling convention of io_init2. Parameter is pushed
                  on the stack, not put in eax.
                  (fixes crash in release ddraw & systems with xf86sup.sys 
                   installed)
    - KERNEL32: o Removed wrong segment definitions introduced by yesterday's
                  EXC_CallHandler rewrite.
                  (fixes global data section)
                o Build fake header for LX executable
                  (fixes crash during Acrobat Reader 5 install (regsvr32.exe))
    - NTDLL:    o Updated rtlstr.c (Wine)
                o Wrote partial implementation of RtlGetAce. Not tested well.
                  Enough to prevent Acrobat Reader 5 install from crashing.
    - ADVAPI32: o Forward AddAce, FindFirstFreeAce, GetAce & AddAccessAllowedAce
                  to NTDLL
    - INSTALL:  o Add Font registry keys 
                  [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Fonts]
                  [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Fonts]
                  "Courier 10,12,15 (VGA res)"="COURE.FON"
                  "MS Sans Serif 8,10,12,14,18,24 (VGA res)"="SSERIFE.FON"
                  "MS Serif 8,10,12,14,18,24 (VGA res)"="SERIFE.FON"

 2001-04-21: Sander van Leeuwen <sandervl@xs4all.nl>
    - KERNEL32: o DosWrite for stdout doesn't accept high addresses
                o Rewrote EXC_CallHandler in assembly (copied compiler output
                  (opt. off))
                  No longer necessary to turn off optimizations for exceptions.cpp.
                o Added partial implementation of GetLongPathNameA/W

 2001-04-20: Sander van Leeuwen <sandervl@xs4all.nl>
    - USER32:   o Commented out RestoreCursor call in user32 exitlist handler.
                  Seems to cause PM hangs on some (a lot?) machines for
                  reasons unknown.

 2001-04-20: Patrick Haller <patrick.haller@innotek.de>
    - DSOUND:   o Fixes / Workaround for PowerDVD 3.0
                  Crashed when allocating sound object for
                  48kHz, 16-Bit, 4 channels
                o dynamically size the internal mixing buffer 
                  in DSMIXER

 2001-04-19: Sander van Leeuwen <sandervl@xs4all.nl>
    - KERNEL32: o Fail properly when a dll can't be found or loaded.
    - SHELL32:  o Ported latest shlfileop.c from Wine. (include functional
                  SHFileOperation). 
                  TODO: Merge the rest.

 2001-04-18: knut st. osmundsen <knut.stange.osmundsen@mynd.no>
    - dailybuild:
                o Adjusted to new build pattern.
                o Copy all builds to local archive directory.
    - tools\install:
                o Added Xx2Lx.
    - Readme.txt:
                o Changed Pe2Lx to Xx2Lx.

 2001-04-17: knut st. osmundsen <knut.stange.osmundsen@mynd.no>
    - Unicode:  o Minor addjustments to makefile. CFLAGS is the correct
                  place to addjust flags for C compilation. And flags
                  are compiler specific.. wrapped it in CCENV checks.
    - Tools\Common:
                o Revamped a couple of things - introduced interface classes.
                  Not quite statisfied yet, but it's working.
                o Starting to make an kFileSDF class to access .SDF files
                  SDF = Structure Definition Files - used by PMDF. Contains
                  information about structures (struct _somthing_s).
                  Needs this information for win32k.
    - Tools\Database:
                o Recreate makefiles, new style. GD is not compiled any longer.
                o Addjusted APIImport to fit changes in Tools\Common.
    - Tools\ImpLib:
                o Addjusted code to fit changes in Tools\Common.

 2001-04-16: Sander van Leeuwen <sandervl@xs4all.nl>
    - KERNEL32: o Fix for LoadLibrary(Ex)W. (free must not be called for
                  converted strings; use FreeAsciiString instead)
    - TOOLS\WRC:o Ported latest wrc. (has proper ascii -> unicode conversion
                  and more features)
                o Open files in binary mode only; fixes load failures for
                  shell32 icons (newlines were translated; bytes removed from
                  icon data)
    - DPLAYX:   o Compile fixes for header changes.
    - include\odin.h:
                o Changes for wrc. It chokes on calling conventions.
                o Got rid of annoying 'unused struct' warnings

 2001-04-16: knut st. osmundsen <knut.stange.osmundsen@mynd.no>
    - DSOUND:   o Removed pmwinx.lib from makefile. Wasn't used; and it had
                  bad path (ie. no path).

 2001-04-15: Sander van Leeuwen <sandervl@xs4all.nl>
    - KERNEL32: o RegQueryValueExA/W broken. Reserved & type parameters reversed.
                  (fixes crash in Notepad and possibly solves many other problems)
    - USER32:   o SetCapture change; return immediately when new capture window
                  is the same as old one.
                  (fixes high cpu load in PowerDVD when holding mouse cursor over
                   control window; PM kept sending WM_MOUSEMOVE messages)
                o Rewrote ClipCursor & GetClipCursor
                o Set PM style flags when WS_CLIPCHILDREN or WS_CLIPSIBLINGS
                  flag is changed by the application using SetWindowLong.
                  (fixes Lotus Notes size bar & upper left rectangle painting)

 2001-04-14: knut st. osmundsen <knut.stange.osmundsen@mynd.no>
    - configure,win32k:
                o Added option to Configure.cmd, -w, which omittes building
                  of Win32k.sys.

 2001-04-12: Shingo Tsuda <sofiya@din.or.jp>
    - USER32:   o Fixes for DBCS strings

 2001-04-10: Sander van Leeuwen <sandervl@xs4all.nl>
    - PELDR:    o Print module name that contributed to the failure of
                  loading kernel32.

 2001-04-06: Sander van Leeuwen <sandervl@xs4all.nl>
    - WINMM:    o Clean up DirectAudio thread properly.

 2001-04-05: Shingo Tsuda <sofiya@din.or.jp>
    - KERNEL32: o WideCharToMultiByte/MultiByteToWideChar changes
                  - srclen <= -1 -> calculate length (docs say only for -1)
                  - source and destination pointer can't be the same (as docs also claim)
                  (verified in Windows ME & Windows NT4, SP6)

 2001-04-05: Sander van Leeuwen <sandervl@xs4all.nl>
    - USER32:   o Rewrote ShowCursor

 2001-04-04: Sander van Leeuwen <sandervl@xs4all.nl>
    - KERNEL32: o Removed AsciiToUnicode* & UnicodeToAscii* functions
                o lstrcpynWtoA & lstrcpynAtoW fixes
                o Removed WideCharToLocal & LocalToWideChar
    - INCLUDE\unicode.h:
                o AsciiToUnicode* & UnicodeToAscii* functions implemented
                  with functions in heapstring.h
    - *         o Compile fixes due to header changes

 2001-04-03: Sander van Leeuwen <sandervl@xs4all.nl>
    - DDRAW:    o Only reset physical palette in DirectDraw destructor if
                  palette was really changed.
                  (gets rid of excessive screen redraws in DXView)
    - KERNEL32: o Return GetUserDefaultLCID in GetSystemDefaultLCID
                o Return GetUserDefaultLangID in GetSystemDefaultLangID
                o Ported Wine's codepage, string & unicode functions (codepage.cpp)
                o Ported Wine's codepage unicode conversion functions & tables
                  (kernel32\unicode)
                o Rewrote string functions (heapstring.cpp) to use new unicode
                  functions.
    - USER32:   o Ported Wine's Char* functions
                  TODO: IsCharAlphaA & IsCharAlphaNumericA

 2001-04-02: Sander van Leeuwen <sandervl@xs4all.nl>
    - USER32:   o Mouse message translation fix (check capture)
                o Turn off WS_CAPTION style for dialogs with DS_CONTROL flag set
                  (fixes file dialogs with OFN_ENABLETEMPLATE style)
                  Verified behaviour in NT4, SP6 with DSShow sample
                  - about dialog with DS_CONTROL -> no titlebar
                  - file open dialog without DS_CONTROL -> titlebar + moveable
                    2nd dialog
                o Temporary workaround for file dialogs with template dialog child.
                  They don't redraw when switching directories. For some reason
                  the new child's (syslistview32) update rectangle stays empty
                  after its parent is made visible with ShowWindow
                  TODO: find real cause
    - MSACM32:  o Ported latest Wine version
    - WINMM:    o Ported latest Wine driver.c (necessary for msacm32 update)
    - DDRAW:    o Back buffer fix; setup surface descriptor structure and
                  don't clear DDSCAPS_BACKBUFFER flag
                  (fix for WinDVD)
                o SurfLock:  hEvent can be 0 as long as the DDLOCK_EVENT flag
                  isn't set.
                  Size of lpSurfaceDesc can be sizeof(DDSURFACEDESC2).
                  (fix for WinDVD)
    - KERNEL32: o Check executable type (VIO/GUI) in CreateProcess and launch
                  correct version of the pe loader (PE/PEC)

 2001-04-02: Michal Necasek <michalnec@volny.cz>
    - KERNEL32: o Fix for importing from executable
                  (fixes Blade Runner)
    - TESTAPP\EXCEPTIONS:
                o Small test apps to test exception handling

 2001-04-01: Sander van Leeuwen <sandervl@xs4all.nl>
    - WININET:  o Added missing exports to wininet.def
    - KERNEL32: o Removed yesterday's codepage change.
                  (breaks Opera)
    - WINMM:    o Increased nr of DART buffers used for wave playback
    - ODININST  o Moved kernel32 init code into odininst
                o Create [HKEY_USERS\.DEFAULT\Control Panel\International]
                  registry key with international settings
    - USER32:   o Create dialog controls with CreateWindowExW
                o Use correct SendMessage(A/W) call during CreateWindow

