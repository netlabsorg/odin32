 /* $Id: changelog,v 1.825 2000-03-21 08:19:36 davidr Exp $ */

 2000-03-20: David Raison <djr@lemur.co.uk>
 	- OLE32: Ported OleQueryCreateFromData, OleCreateFromData from
 	         wine/corel sources.
 	- OLEAUT32: Bugfix in ITypeLibImpl_GetDocumentation

 2000-03-20: Sander van Leeuwen <sandervl@xs4all.nl>
	- WSOCK32: Fixed relay bug in WSAAsyncSelect (delete relay slot 
                   with same socket nr & window handle; there can
                   be more selects per window)

 2000-03-19: David Raison <djr@lemur.co.uk>
 	- OLE32: Bugfixes.
 	         Ported changes from wine/corel sources.
 	         Created ReadClassStm, WriteClassStm, ProgIDFromCLSID

 2000-03-19: Sander van Leeuwen <sandervl@xs4all.nl>
	- ODINCRT: Fixed FS wrapper for _fdopen & others in file.cpp
                   (missing SetFS)

 2000-03-19: Michal Necasek <mike@mendelu.cz>
        - DINPUT: Few fixes, now Fallout 1/2 almost works

 2000-03-18: Michal Necasek <mike@mendelu.cz>
        - DDRAW: Fixed messed up DPA callback calling convention
                 Added some transparent blit code which was
                 mysteriously missing

 2000-03-18: Edgar Buerkle <Edgar.Buerkle@gmx.net>
        - MSVCRT: Implemented _EH_prolog

 2000-03-18: Christoph Bratschi <cbratschi@datacomm.ch>
        - USER32: merged with Corel WINE 20000317
                  added GCL_HICONSM support
                  fixed messagebox with no icon
        - COMCTL32: merged with Corel WINE 20000317 + bug fixes

 2000-03-18: Sander van Leeuwen <sandervl@xs4all.nl>
        - ODINCRT: Added FS wrapper for _fdopen
                   (fixes crash at exit in Professional MineSweeper when
                    selection About Odin from the system menu)

 2000-03-17: Christoph Bratschi <cbratschi@datacomm.ch>
        - COMCTL32: fixed trackbar buddy alignment
                    added useful internal tooltip styles

 2000-03-17: Sander van Leeuwen <sandervl@xs4all.nl>
        - WSOCK32: Semaphore protection for relay slot alloc/free
                   Fixed bug in WSAAsyncSelect.  Allow more than one
                   async call per window for RelayAlloc call. If it's not
                   alloced, pmwsock will return an error. Previously it was
                   overwriting slots for other async calls. (WSAAsyncGetHostName
                   in RealPlayer 7)
        - KERNEL32: Fixed handle creation for thread 0.

 2000-03-16: knut st. osmundsen <knut.stange.osmundse@pmsc.no>
    - TOOLS\FASTDEP:
            Speed optimizations: using AVL trees, include dir caching,
                dependencies stored in AVL tree until all files has been
                processes, buffered write.
            Cyclic dependency check.
            All files but the objectfiles now should have fully qualified paths.

    - INCLUDE\PDWIN32.TOOLS:
            DEPEND: Enabled cyclic check.

 2000-03-16: Sander van Leeuwen <sandervl@xs4all.nl>
        - USER32: Fixed virtual keycode of return key
                  TODO: Not done for all keys. Should probably looks at the
                        scancode (not virtual char) to translate keys.
        - GDI32:  RP7 calls CreateDIBSection with HDC 0; Call
                  GetWindowDC(GetDesktopWindow()) in that case
                  -> fixes crash (result of CreateDIBSection failure)
                  TODO: Looks like this is allowed in NT, but need to check
                        this to be sure nothing else caused this problem.
                  (Note: most recent RealPlayer 7 version only)
        - KERNEL32: Semaphore protection of handle alloc
                    Added handlemanager class for thread handles
                    Added workaround for Open32 WaitForSingleObject bug
                    (if thread is terminated and WaitForSingleObject is
                     called with the thread's handle -> never returns
                     (new rp7 hang at exit))
                    TODO: WaitForMultipleObjects can still hang ->
                          Event, semaphore, mutex & wait apis need to
                          be redesigned (not using Open32)

 2000-03-14: Christoph Bratschi <cbratschi@datacomm.ch>
        - USER32: implemented much faster LB_SETCOUNT

 2000-03-12: Sander van Leeuwen <sandervl@xs4all.nl>
        - USER32: Put back check (oldsel == newsel) in LISTBOX_SetSelection
                  (why was this commented out?)
                  Fixed combobox: Clear CBF_SELCHANGE flag before calling
                                  CBUpdateEdit
                                  Don't send CBN_EDITUPDATE when CBF_NOEDITNOTIFY
                                  flag is set (by combo_handletext)
                  -> fixes infinite loops in RealPlayer 7 (type name of file
                     previously used in edit box; last letter entered -> crash)
                  AdjustWindowRectEx bugfix (reported by Robert Lalla)
                  Don't clear WS_POPUP flag. (HAS_THINFRAME depends on it)
                  -> fixes wrong resolution changes in Quake 2
                  Don't clear WS_CHILD flag either. (HAS_THICKFRAME depends on it)

        - KERNEL32: Clear FILE_SHARE_DELETE flag before calling Open32's
                    CreateFile. (otherwise it fails) -> fixes RealPlayer 7
                    Basic (new update).

        - WSOCK32: Changed workaround for setsockopt bug (SO_SNDBUF/SO_RCVBUF (OS/2's
                   winsock returns WSAEINVAL if size > 64k))
                   Only change size if setsockopt returns WSAINVAL (32 bits stack
                   should support size > 64 kb (?))
                   Added selective logging feature.

 2000-03-12: Markus Montkowski <mmontkowski@gmx.de>
        - KERNEL32: Added fix for GetFileAttributes. Open32 doesn't like
                    i.e. 'c:'; needs to be changed into 'c:\'

 2000-03-12: Sander van Leeuwen <sandervl@xs4all.nl>
        - include\winconst.h: Fixed KEY_ALL_ACCESS definition
                              (reported by Yuri Dario)
        - DSOUND: Replaced dsound by new version
        - USER32: Replaced os2.h includes by os2wrap.h
                  Set message nr, wParam & lParam to 0 for dummy messages
                  (to prevent keyboard or mouse messages swallowed by dinput
                   from being dispatched)
        - KERNEL32: Replaced os2.h includes by os2wrap.h (cvtcursorgrp & oslibdebug)
        - WSOCK32: Fixed bug in setsockopt for SO_SNDBUF/SO_RCVBUF (OS/2's
                   winsock returns WSAEINVAL if size > 64k)

 2000-03-12: Michal Necasek <mike@mendelu.cz>
        - dsound\new: Fixed sound in Heroes of M&M III

 2000-03-11: Przemyslaw Dobrowolski <dobrawka@asua.org.pl>
        - OPENGL\GLIDE: Fix for Voodoo 1 glide (missing io ports)

 2000-03-11: knut st. osmundsen <knut.stange.osmundse@pmsc.no>
        - OPENGL\GLUT: Fix for gettimeofday. This is defined conflicting in
                the toolkit sys\time.h.
        - TOOLS\BIN: Implemented an optional directory locking in
                dowithdirs.cmd. (Useful for SMP builds.)

 2000-03-11: Sander van Leeuwen <sandervl@xs4all.nl>
        - OPENGL\GLUT: Fixed compile problems + cleanup
                       (use C(XX)FLAGS_WIN32APP so you don't have to
                        explicitely specify which api type you use (ascii or unicode)!)

        - OPENGL\GLIDE: Fixed wrong binary path for voodoo1 glide
        - include\win\debugtools.h: Disable TRACE, WARN etc when DEBUG is not defined

 2000-03-11: Jeroen van den Horn <J.vandenHorn@fibre.a2000.nl>
        - OPENGL: Fixed error preventing build to complete

 2000-03-09: Sander van Leeuwen <sandervl@xs4all.nl>
        - KERNEL32: Set initial max nr of file handles to 256 during kernel32 init
                    Create DDRAW & DSOUND registry keys in InitRegistry
                    (NOTE: Must be done in install program!)
                    Added some win95 stubs
        - GDI32:    Added 16 bits device apis stubs

 2000-03-10: Michal Necasek <mike@mendelu.cz>
        - dsound\new: Changed DART buffer size calcualation, hopefully
                      WinAmp will sound better now.

 2000-03-09: knut st. osmundsen <knut.stange.osmundse@pmsc.no>
        - include\pdwin32.tools: New tool, EXISTS --> \tools\bin\Exists.cmd
        - tools\bin\Exists.cmd: New tool which checks if the file passed in
                exists. If the file exists it returns 0, else 1. This is
                used to check if .depend and other files exists in the
                makefiles. (See pdwin32.post to see how.)
        - include\pdwin32.post: .depend is only included if it exists. You'll
                get a warning if it don't, but the makefile works fine.
                Added a check on OBJDIR not being empty in the clean rule.
                $(RM) $(OBJDIR)\* is will remove all files in the root dir if
                OBJDIR is empty.
        - win32k: Updated makefile with the use of EXISTS for both .depend and
                makfile.inc. An update check for makefile.inc <-> configure.cmd
                was also added.
                Added checks for empty variables in clean rule, and we no longer
                deletes * in any directory.

        A CVS tip:
            When new directories are added you have to to a 'cvs checkout .'
            from the root.
            A 'cvs update' don't get the new directories it seems
        (There have been added some dirs under win32k lately so please do this.)

 2000-03-09: Sander van Leeuwen <sandervl@xs4all.nl>
        - KERNEL32: Major rewrite of PE loader classes to correctly support
                    dll dependencies
                    TODO: Circular dependencies only partly working
                          (a->b->a works, but a->b->c->a doesn't)
        - USER32: Fixed bug in dialog constructor (class name translation)
                  (only showed up in release build)
                  Dinput mouse changes/fixes

 2000-03-08: Michal Necasek <mike@mendelu.cz>
        - dsound\new: Fixed volume and panning calculation that
                      sometimes caused ugly noise

 2000-03-08: Michal Necasek <mike@mendelu.cz>
        - dsound\new: Completely new DART-based DirectSound. Works fine
                      for me with Quake 3, Moorhuhn and WinAmp.

 2000-03-07: knut st. osmundsen <knut.stange.osmundse@pmsc.no>
        - makefiles and include\pdwin32.*:
            * Updated nearly all makefiles to the new makefile style.
              Win32k, pe2lx and some subdirs of Winmm
            * Odin32 resource files are now to have the extention .orc
              All files have, save some under WinMM and in old/new dirs,
              been renamed. There are now new interference rules in
              pdwin32.tools which will create the resource assembly and
              assemble it into an object file. So you simply have to
              specify the output object file for Odin32 resources along
              with the other object files.
            * A little not on forwarders. ILINK returns a warning code of
              4 when aliases are generated. An errorcode <> 0 stops NMAKE
              normally. To workaround these problem we simply tell NMAKE to
              accespt all error codes in the range 0-4. This is done by
              putting '-4 ' in front of the $(LD2) statement.
              I don't want to see _any_ '-$(LD2)'!!!


 2000-03-06: Sander van Leeuwen <sandervl@xs4all.nl>
        - USER32: Fixed bug in edit control
                  If nyoff > nr lines in control -> bottom line in control
                  window should show last line of control
                  Wine code shows last line at the top of the control
                  (Quake 3 startup edit control shows the problem)

 2000-03-05: knut st. osmundsen <knut.stange.osmundse@pmsc.no>
        - include\pdwin32.vac*: Added OS2RC and OS2RCFLAGS. This defines the
                OS/2 resource compiler and the flags used during compilation.
                When it comes to linking we should assume NO flags and simply
                invoke the it like this: $(OS2RC) <source>.res <target>.dll.
                (See src\kernel32\makefile for an example.)

 2000-03-05: Jeroen van den Horn <J.vandenHorn@fibre.a2000.nl>
        - GLUT32: Really fixed optimized build now. Was not a VACPP bug but
                  error in calling convention prototype in glutint.h

 2000-03-04: Jeroen van den Horn <J.vandenHorn@fibre.a2000.nl>
        - GLUT32: Added logic to escape from optimizer bug in VACPP

 2000-03-04: knut st. osmundsen <knut.stange.osmundse@pmsc.no>
        - fastdep: Simple preprocessor. Commments and #if 0/1.
        - OPENGL: Corrected makefiles. using LD2 and LD2FLAGS. Many makefiles
                 Didn't concider the NODEBUGINFO macro causing daily builds
                 to become enormous. Daily build of 6MB is not good!.
        - include\pdwin32.v*.*:
                *Alternate linker tool, LD2. This is ilink for VAC.
                 (See src\kernel32\makefile for hints how to use it).
                *Synced configuration for the two VAC versions.

                 NOTE that NODEBUGINFO and DEBUGALL is handled within these
                 files. You don't have to test for them to set the correct
                 compiler and linker flags, this is allready done!

 2000-03-04: Sander van Leeuwen <sandervl@xs4all.nl>
        - INCLUDE\pdwin32.tools, pdwin.vac*
                   Added new build rules (conditional at this time)
                   For each dll a subdir bin\release & bin\debug is created
                   in which the object files of the release & build version
                   are saved.
        - INCLUDE\pdwin32.post
                   Common makefile rules to be included by all makefiles
        - USER32\KERNEL32: Switched to new build rules
        - WSOCK32: Fixed bug in setsockopt for SO_LINGER (options size wasn't
                   adjusted)
        - KERNEL32: Fixed shell dirs (now all created in odin\bin dir)
                    Partially fixed destruction of loaded dlls in ExitProcess
                    (TODO: dependencies are not yet right; needs new design)
                    Added check and fix for DosOpen (ERROR_TOO_MANY_OPEN_FILES)
                    to hmdevio.cpp
        - USER32: Pass on keyboard messages if dinput handler returns TRUE
                  Also send non-client mouse messages to dinput
                  (TODO: always returns true after calling dinput handler)
        - OPENGL\GLIDE:
                  Added check and fix for DosOpen (ERROR_TOO_MANY_OPEN_FILES)
                  to hmdevio.cpp (reported by Michal Necasek)

 2000-03-03: Markus Montkowski <mmontkowski@gmx.de>
        - DDRAW:  Fixed bug in CreateSurface and QueryInterface
                  (Moorhuhn now starts fine with ddraw)
        - USER32: Changed VirtualKey for VK_NEWLINE from 0x0A to 0x0D
                  in the virtualKeyTable

 2000-03-03: Sander van Leeuwen <sandervl@xs4all.nl>
        - KERNEL32: Create shell dirs in odin\bin directory
                    Cleanup (never call Open32 apis directly if the proc
                    isn't a wrapper; include win32api.h and call Odin api)
                    Fixed FS corruption for DosAliasMem
                    Fixed bug in Win32PeLdrImage::commitPage (quake 3 screensaver's
                    fixup section doesn't start on page boundary)
        - ADVAPI32/KERNEL32: Moved registry apis in kernel32 as we need them
                             there (importing them directly creates a circular
                             dependency (kernel32->advapi32->kernel32))
                             Should probably be moved to ntdll
        - WINMM: Fixed typo in DartWaveOut::init to determine bits per sample
                 (Realplayer 7 audio now works (when playing .rm files))

 2000-03-03: Jeroen van den Horn <J.vandenHorn@fibre.a2000.nl>
        - KERNEL32: Fixed calling convention bug in conprop2.cpp
                    (caused crashes with release build)

 2000-03-02: Sander van Leeuwen <sandervl@xs4all.nl>
        - OPENGL\GLIDE:         Use Odin OS/2 api wrappers in fxos2.cpp
        - OPENGL\MESA:          Reapplied TLS fixes
                                Check for null pointer in wglSetPixelFormat
        - OPENGL\MESA\3dfx:     Use c files from Mesa dir
                                Check for null pointer in wglSetPixelFormat
        - WINMM: Fixed DartWaveOut::getPosition (overflow)
                 (fixes mp3 playback in RealPlayer 7)
        - KERNEL32: Fixed SetCurrentDirectory (don't remove backslash
                    if app wants to change dir to "\")
                    Create shell folders + shell keys
                    (NOTE: This has to be done in the odin install program
                           once we have one)
        - ADVAPI32: Added crypt api stubs

 2000-03-01: Jeroen van den Horn <J.vandenHorn@fibre.a2000.nl>
        - OPENGL: Implemented DIVE support in Mesa

 2000-03-01: Sander van Leeuwen <sandervl@xs4all.nl>
        - USER32: Fixes for FindWindow(ExA/W) - now more like Wine
                  (FindWindowExW was not working correctly either)
                  First send WM_NCACTIVATE, then WM_ACTIVATE
                  Fixed focus problems with Odin apps
                  (Call WinSetFocus in OSLibWinSetActiveWindow instead of
                   WinSetActiveWindow when a user clicks on the titlebar
                   of an inactive window & after sending WM_MOUSEACTIVATE)
                  TODO: Does WinSetActiveWindow work properly or should we
                        always call WinSetFocus???
                  Call Dinput handler when translating mouse & keyboard
                  messages (during Get/PeekMessage)
        - OPENGL: Always build release version of glide, mesa, glu32 & glut
                  Build mesa software & 3dfx dlls; don't build OS/2 opengl
                  wrapper anymore
        - OPENGL\GLIDE\CVG\GLIDE:
                  Disable instruction scheduling in release build -> messed up
                  colors when turned on (most likely VAC optimizer bug)
                  TODO: Somebody should also check this for the voodoo 1 glide dll.
        - OPENGL\GLIDE\CVG:
                  Fixed makefile
        - OPENGL\MESA\GL\gl.h
                  Removed circular header dependency (breaks build)
        - OPENGL\MESA\3dfx:
                  Copy 3dfx opengl32.dll to bin\glide

 2000-03-01: Edgar Buerkle <Edgar.Buerkle@gmx.net>
        - USER32: Fixed dprintf in CreateWindowExW
                  Added left & right cursor keys to Win32BaseWindow::setExtendedKey

