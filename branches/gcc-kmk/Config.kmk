## @file
# Global Project Configuration File
#

#------------------------------------------------------------------------------
# Global definitions
#------------------------------------------------------------------------------

# Handler for Wine RC (.orc) source files
KBUILD_SRC_HANDLERS += .orc:def_src_handler_wrc
define def_src_handler_wrc
local type := WRC
 $(kb-src-one 2)
endef

#------------------------------------------------------------------------------
# Tools
#------------------------------------------------------------------------------

# Add support for Wine RC to the GCC compiler
TOOL_GXX3OMF_WRC                = $(PATH_STAGE_BIN)/winerc.exe
TOOL_GXX3OMF_WRCOBJSUFF         = .o
TOOL_GXX3OMF_COMPILE_WRC_OUTPUT = $(outbase).orc.s
TOOL_GXX3OMF_COMPILE_WRC_DEPEND =
TOOL_GXX3OMF_COMPILE_WRC_DEPORD =
define TOOL_GXX3OMF_COMPILE_WRC_CMDS
	$(QUIET)$(TOOL_GXX3OMF_WRC) -s\
        $(flags) $(addprefix -I, $(subst /,\\,$(incs))) $(addprefix -D, $(defs))\
        $(subst /,\\,$(abspath $(source))) \
        -o $(TOOL_GXX3OMF_COMPILE_WRC_OUTPUT)
	$(subst $(source),$(TOOL_GXX3OMF_COMPILE_WRC_OUTPUT),$(TOOL_GXX3OMF_COMPILE_AS_CMDS)))
endef

#------------------------------------------------------------------------------
# Common libraries referenced by components
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# General Stuff
#------------------------------------------------------------------------------

TEMPLATE_OdinCxx            = Odin C/C++ sources
TEMPLATE_OdinCxx_TOOL       = GXX3OMF
TEMPLATE_OdinCxx_INCS       = $(PATH_ROOT)/include/win $(PATH_ROOT)/include $(PATH_ROOT)/include/incl_gcc
TEMPLATE_OdinCxx_DEFS       = __WIN32OS2__ __WINE__ __i386__ TCPV40HDRS COMCTL32UNDOC

TEMPLATE_OdinCRT            = OdinCRT library
TEMPLATE_OdinCRT_EXTENDS    = OdinCxx
TEMPLATE_OdinCRT_EXTENDS_BY	= overriding
TEMPLATE_OdinCRT_DEFS       = __WIN32OS2__ __WINE__ __i386__

TEMPLATE_OdinCRT            = Win32 application
TEMPLATE_OdinCRT_EXTENDS    = OdinCxx
TEMPLATE_OdinCRT_EXTENDS_BY	= overriding
TEMPLATE_OdinCRT_DEFS       = __WIN32OS2__ __i386__

TEMPLATE_OdinCxxDLL             = Odin C/C++ DLL
TEMPLATE_OdinCxxDLL_EXTENDS     = OdinCxx
TEMPLATE_OdinCxxDLL_EXTENDS_BY	= overriding
TEMPLATE_OdinCxxDLL_LIBS        = $(TEMPLATE_OdinCxx_LIBS) $(INSTTARGET_initdll)

#------------------------------------------------------------------------------
# GCC Stuff
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Other Stuff
#------------------------------------------------------------------------------

#
# Include a site-specific config for local overrides
#
ifndef LOCALCFG
 LOCALCFG := $(wildcard $(PATH_ROOT)/LocalConfig.kmk)
 ifneq ($(LOCALCFG),)
  include $(LOCALCFG)
 endif
endif
